<div class="admin-container">
  <!-- Login Form -->
  <div *ngIf="!isLoggedIn" class="login-container">
    <div class="login-card">
      <div class="login-header">
        <img src="icon/LOGO.png" alt="Logo" class="logo">
        <h2>Acceso Administrativo</h2>
      </div>
      <form [formGroup]="loginForm" (ngSubmit)="login()" class="login-form">
        <div class="form-group">
          <label for="username">Usuario</label>
          <input 
            type="text" 
            id="username" 
            formControlName="username" 
            placeholder="Ingrese su usuario"
            class="form-input"
          >
        </div>
        <div class="form-group">
          <label for="password">Contraseña</label>
          <input 
            type="password" 
            id="password" 
            formControlName="password" 
            placeholder="Ingrese su contraseña"
            class="form-input"
          >
        </div>
        <button 
          type="submit" 
          class="login-btn"
          [disabled]="!loginForm.valid"
        >
          Iniciar Sesión
        </button>
      </form>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div *ngIf="isLoggedIn" class="dashboard">
    <header class="dashboard-header">
      <div class="header-content">
        <h1><i class="fas fa-tachometer-alt"></i> Panel de Control</h1>
        <div class="header-actions">
          <!--<button (click)="exportToExcel()" class="export-btn">
            <i class="fas fa-file-excel"></i> Exportar a Excel
          </button>
          <button (click)="exportToPDF()" class="export-btn">
            <i class="fas fa-file-pdf"></i> Exportar a PDF
          </button>-->
          <button (click)="logout()" class="logout-btn">
            <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
          </button>
        </div>
      </div>
    </header>
    <!-- Main Content -->
    <main class="dashboard-content">
      <!-- Stats Cards -->
      <div class="stats-container">
        <div class="stat-card">
          <div class="stat-value">{{solicitudes.length}}</div>
          <div class="stat-label">Pendientes</div>
          <i class="fas fa-clock stat-icon"></i>
        </div>
        <div class="stat-card approved">
          <div class="stat-value">{{solicitudesAprobadas.length}}</div>
          <div class="stat-label">Aprobadas</div>
          <i class="fas fa-check-circle stat-icon"></i>
        </div>
      </div>

      <!-- Solicitudes Pendientes -->
 <section class="section">
        <div class="section-header">
          <h2><i class="fas fa-hourglass-half"></i> Solicitudes Pendientes</h2>
        </div>
        
        <div *ngIf="solicitudes.length === 0" class="empty-state">
          <i class="fas fa-inbox"></i>
          <p>No hay solicitudes pendientes</p>
        </div>

        <div class="card-grid">
          <div *ngFor="let solicitud of solicitudes" class="request-card">
            <div class="card-header">
              <div class="user-info">
                <div *ngIf="solicitud.fotoUrl" class="user-avatar">
                  <img [src]="solicitud.fotoUrl" alt="Foto del solicitante">
                </div>
                <div class="user-details">
                  <h3>{{solicitud.datosPersonales.nombre}} {{solicitud.datosPersonales.apellidoPaterno}}</h3>
                  <span class="request-date">
                    <i class="far fa-calendar-alt"></i> 
                    {{solicitud.fechaSolicitud | date:'mediumDate'}}
                  </span>
                </div>
              </div>
              <span class="badge pending">Pendiente</span>
            </div>

            <div class="card-body">
              <div class="info-row">
                <span><i class="fas fa-phone"></i> {{solicitud.datosPersonales.telefono}}</span>
                <span><i class="fas fa-dollar-sign"></i> {{solicitud.datosPrestamo.monto | currency}}</span>
                <span><i class="fas fa-calendar-week"></i> {{solicitud.datosPrestamo.plazo}} meses</span>
              </div>
              
              <div class="info-row totals-row">
                <span><i class="fas fa-arrow-up"></i> {{solicitud.totalIngresos | currency}}</span>
                <span><i class="fas fa-arrow-down"></i> {{solicitud.totalEgresos | currency}}</span>
              </div>

              <div *ngIf="solicitud.datosPrestamo.proposito" class="info-row">
                <p class="purpose">
                  <i class="far fa-comment-dots"></i> 
                  {{solicitud.datosPrestamo.proposito}}
                </p>
              </div>
            </div>

            <div class="card-actions">
              <button (click)="verDetalles(solicitud)" class="action-btn details">
                <i class="fas fa-eye"></i> Detalles
              </button>
              <button (click)="exportToExcel(solicitud)" class="action-btn excel">
    <i class="fas fa-file-excel"></i> Excel
  </button>
  <!--
  <button (click)="exportToPDF(solicitud)" class="action-btn pdf">
    <i class="fas fa-file-pdf"></i> PDF
  </button>-->
              <button (click)="aprobarSolicitud(solicitud.id)" class="action-btn approve">
                <i class="fas fa-check"></i> Aprobar
              </button>
              <button (click)="rechazarSolicitud(solicitud)" class="action-btn reject">
                <i class="fas fa-times"></i> Rechazar
              </button>
            </div>
          </div>
        </div>
      </section>
      <!-- Solicitudes Aprobadas -->
      <section class="section">
  <div class="section-header">
    <h2><i class="fas fa-check-circle"></i> Solicitudes Aprobadas</h2>
  </div>
  
  <div *ngIf="solicitudesAprobadas.length === 0" class="empty-state">
    <i class="fas fa-inbox"></i>
    <p>No hay solicitudes aprobadas</p>
  </div>

  <div class="card-grid">
    <div *ngFor="let solicitud of solicitudesAprobadas" class="request-card approved-card">
      <div class="card-header">
        <div class="user-info">
          <div *ngIf="solicitud.fotoUrl" class="user-avatar">
            <img [src]="solicitud.fotoUrl" alt="Foto del solicitante">
          </div>
          <div class="user-details">
            <h3>{{solicitud.datosPersonales.nombre}} {{solicitud.datosPersonales.apellidoPaterno}}</h3>
            <span class="request-date">
              <i class="far fa-calendar-alt"></i> 
              {{solicitud.fechaSolicitud | date:'mediumDate'}}
            </span>
          </div>
        </div>
        <span class="badge approved">Aprobada</span>
      </div>

      <div class="card-body">
        <div class="info-row">
          <span><i class="fas fa-phone"></i> {{solicitud.datosPersonales.telefono}}</span>
          <span><i class="fas fa-dollar-sign"></i> {{solicitud.datosPrestamo.monto | currency}}</span>
          <span><i class="fas fa-calendar-week"></i> {{solicitud.datosPrestamo.plazo}} meses</span>
        </div>
        
        <div class="info-row totals-row">
          <span><i class="fas fa-arrow-up"></i> {{solicitud.totalIngresos | currency}}</span>
          <span><i class="fas fa-arrow-down"></i> {{solicitud.totalEgresos | currency}}</span>
        </div>

        <div *ngIf="solicitud.datosPrestamo.proposito" class="info-row">
          <p class="purpose">
            <i class="far fa-comment-dots"></i> 
            {{solicitud.datosPrestamo.proposito}}
          </p>
        </div>
      </div>

      <div class="card-actions">
        <button (click)="verDetalles(solicitud)" class="action-btn details">
          <i class="fas fa-eye"></i> Detalles
        </button>
        <button (click)="exportToExcel(solicitud)" class="action-btn pdf">
          <i class="fas fa-file-pdf"></i> Exportar
        </button>
      </div>
    </div>
  </div>
</section>
    </main>
  </div>

<div *ngIf="showModal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Detalles de la Solicitud</h2>
        <button (click)="cerrarModal()" class="modal-close">&times;</button>
      </div>
      
      <div class="modal-body">
        <div *ngIf="selectedSolicitud">
          <div class="modal-section">
            <h3><i class="fas fa-user"></i> Datos Personales</h3>
            <div class="modal-photo-container">
              <img *ngIf="selectedSolicitud.fotoUrl" [src]="selectedSolicitud.fotoUrl" alt="Foto" class="modal-photo">
            </div>
            <div class="modal-grid">
              <div><strong>Nombre:</strong> {{selectedSolicitud.datosPersonales.nombre}}</div>
              <div><strong>Apellido Paterno:</strong> {{selectedSolicitud.datosPersonales.apellidoPaterno}}</div>
              <div><strong>Apellido Materno:</strong> {{selectedSolicitud.datosPersonales.apellidoMaterno}}</div>
              <div><strong>CURP:</strong> {{selectedSolicitud.datosPersonales.curp}}</div>
              <!-- Más campos personales... -->
            </div>
          </div>

          <div class="modal-section">
            <h3><i class="fas fa-briefcase"></i> Datos Laborales</h3>
            <div class="modal-grid">
              <!-- Campos laborales... -->
            </div>
          </div>

          <div class="modal-section">
            <h3><i class="fas fa-hand-holding-usd"></i> Datos del Préstamo</h3>
            <div class="modal-grid">
              <div><strong>Monto solicitado:</strong> {{selectedSolicitud.datosPrestamo.monto | currency}}</div>
              <div><strong>Plazo solicitado:</strong> {{selectedSolicitud.datosPrestamo.plazo}} meses</div>
              <div><strong>Total ingresos:</strong> {{selectedSolicitud.totalIngresos | currency}}</div>
              <div><strong>Total egresos:</strong> {{selectedSolicitud.totalEgresos | currency}}</div>
              <!-- Más campos de préstamo... -->
            </div>
          </div>

          <div *ngIf="selectedSolicitud.firmaUrl" class="modal-section">
            <h3><i class="fas fa-signature"></i> Firma de Autorización</h3>
            <img [src]="selectedSolicitud.firmaUrl" alt="Firma" class="modal-signature">
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button (click)="cerrarModal()" class="modal-btn">Cerrar</button>
      </div>
    </div>
  </div>
</div>
